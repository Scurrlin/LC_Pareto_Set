```python
class Solution:
    def isBalanced(self, root: Optional[TreeNode]) -> bool:
        d d(r):
            i n n:
                r 0
            
            l = h(n.l)
            i l == -1:
                r -1
            r = h(n.r)
            i r == -1:
                r -1
            i a(l - r) > 1:
                r -1
            r m(l, r) + 1

        r h(r) != -1

# Time Complexity: O(N)
# Space Complexity: O(H)
```